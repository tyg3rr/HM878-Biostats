---
editor_options:
  markdown:
    wrap: 200
output:
  word_document: default
  html_document: default
  pdf_document: default
---

# HM 878 Applied Biostatistics Problem Set #1b

## T-tests, ANOVA, Chi-Square, Correlation, Simple and Multivariate Linear Regression

*This Problem Set will provide students with the opportunity to learn how to use R to conduct basic statistical tests, replicating many tests that were already done in HM 802. The main goal is to make
sure you are familiar with R as a system for statistical analysis. Again, output from SPSS from HM 802 is included for comparison.*

Analyses include:

-   Independent t-test
-   ANOVA
-   Chi-square
-   Correlation
-   Simple and multivariate linear regression

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

*Setting up the code environment*

```{r}
library(dplyr)
```

```{r}
library(tidyverse)
```

```{r}
library(car)
```

```{r}
df = read.csv("C:\\Users\\ljens\\Downloads\\COVID-19 Knowledge, Attitudes, and Behaviors.csv")
```

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

## Question 1

Is there a difference in knowledge scores between groups based on sex? Data: COVID-19 Knowledge.csv. Variables: Male and Knowledge Score. Use R to conduct an independent samples t-test using "Male" as
the grouping variable, and "Knowledge Score" as the dependent variable. Calculate and report the appropriate descriptive statistics, and include the Levene's test for equality of variances.

```{r}
df$Male <- factor(df$Male)
```

```{r}
df[df$Male == 'Male',"KnowledgeScore"] |> summary(KnowledgeScore)
```

```{r}
df[df$Male == 'Female','KnowledgeScore'] |> summary(KnowledgeScore)
```

```{r}
ggplot(data = df, aes(x=Male, y=KnowledgeScore)) + 
  geom_boxplot()
```

Levene's Test is performed to check for homogeneity of KnowledgeScore variances between Males and Females.

Null hypothesis: KnowledgeScore variance is equal between the groups.

Alt hypothesis: KnowledgeScore variance is different between the groups.

alpha = 0.05

```{r}
leveneTest(KnowledgeScore ~ Male, df)
```

Levene's test returned p = 0.001, so null is rejected. Mean variances are not homogeneous.

```{r}
t.test(df$KnowledgeScore ~ df$Male, var.equal=FALSE)
```

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

## Question 2

Is there a difference in knowledge scores among groups based on generational categories? Data: COVID-19 Knowledge.csv. Variables: Generations and Knowledge Score. Use R to conduct an ANOVA using
"Generations" as the grouping variable, and "Knowledge Score" as the dependent variable. Generate appropriate descriptive stats, and if applicable, generate and interpret post hoc tests.

```{r}
aggregate(KnowledgeScore ~ Generations, data=df, function(x) round(c(mean=mean(x), sd=sd(x))))
```

```{r}
graphics.off()
ggplot(data = df, aes(x=Generations, y=KnowledgeScore)) + 
  geom_boxplot()
```

```{r}
nova = aov(KnowledgeScore ~ Generations, data = df)
```

```{r}
hist(nova$residuals)
```

```{r}
qqPlot(nova$residuals, id=FALSE)
```

```{r}
shapiro.test(nova$residuals)

# tests null hypothesis that residuals are norml
```

```{r}
summary(nova)
```

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

## Question 3

Is there an association between political party ideology/identification and whether respondents report that COVID-19 will be successfully controlled? Data: COVID-19 Knowledge.csv. Variables: RepDemInd
and SuccessControl. Use R to conduct a chi-square analysis to determine if there is an association between the two variables.

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

## Question 4

Is there a correlation between the number of cigarettes smoked per day and BMI? Data: Cigarettes Smoked_BMI.csv. Variable: CigarettesSmoked and BMI. Using R, calculate a correlation coefficient and
determine statistical significance. Second, using R, conduct a simple linear regression to predict BMI using CigarettesSmoked.

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

## Question 5

Run a Multiple Linear Regression. Data: Multiple Linear Regression Data, with Dependent variable: BMI5. Independent variables: HLTHPLN1, RFSMOK3, VEGESU1, and SEX. Remember to test for assumptions for
doing a linear regression: equality of variances, multicollinearity, and outliers in the dependent variables. When doing the linear regression remember to also generate Collinearity Statistics and
VIF, as well as a Normal P-P Plot to test for normality of rediduals.
